<html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="firebase-storage-behavior.html"><script>(function(){'use strict';Polymer({is:'firebase-storage-ref',properties:{downloadUrl:{type:String,notify:!0},metadata:{type:Object,notify:!0},storageUri:{type:String,notify:!0},uploadTask:{type:Object,notify:!0}},behaviors:[Polymer.FirebaseStorageBehavior],observers:['__pathChanged(path, storage)'],get isNew(){return!this.path},get zeroValue(){return[]},__pathChanged:function(a){this.storage&&(this.getDownloadURL(a).then(function(a){this.downloadUrl=a}.bind(this)).catch(function(a){this.fire('error',a,{bubble:!1})}.bind(this)),this.getMetadata(a).then(function(a){this.metadata=a}.bind(this)).catch(function(a){this.fire('error',a,{bubble:!1})}.bind(this)),this.storageUri=this.toGsString(a))},reset:function(){return this.path=null,Promise.resolve()},setPathFromUrl:function(a){return a?(this.path=this.getPathFromUrl(a),new Promise.resolve):new Promise.resolve},getPathFromUrl:function(a){return a?this.storage.refFromURL(a):null},delete:function(){return this.__put().then(function(){return this.reset()}.bind(this))},put:function(a,b){return this.uploadTask=this.__put(null,a,b),this.uploadTask},putString:function(a,b,c){return this.uploadTask=this.__putString(null,a,b,c),this.uploadTask},getDownloadURL:function(a){if(a)return this.storage.ref(a).getDownloadURL();return this.ref?this.ref.getDownloadURL():new Promise(function(a){a()})},getMetadata:function(a){if(a)return this.storage.ref(a).getMetadata();return this.ref?this.ref.getMetadata():new Promise(function(a){a()})},toGsString:function(a){if(a)return this.storage.ref(a).toString();return this.ref?this.ref.toString():void 0},setMetadata:function(a,b){if(b)return this.storage.ref(b).updateMetadata(a);return this.ref?this.ref.updateMetadata(a):new Promise(function(a){a()})}})})();</script></head><body></body></html>